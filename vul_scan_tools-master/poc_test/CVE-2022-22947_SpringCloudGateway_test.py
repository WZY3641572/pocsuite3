import json
from pocsuite3.api import init_pocsuite, start_pocsuite, get_results


def run_poc():
    config = {
        "url": ["http://xxxxxx:9000/"],
        "poc": ["../plugins/command_injection/CVE-2022-22947_SpringCloudGateway.py"],
    }

    init_pocsuite(config)
    start_pocsuite()
    results = get_results()
    for result in results:
        result_dict = result.get("result")
        if result_dict:
            print(json.dumps(result_dict, indent=4))


if __name__ == "__main__":
    run_poc()
